# 智能列名匹配测试说明

## 测试文件说明

本目录包含10个不同格式的Excel文件，用于测试智能列名匹配功能：

### 文件列表及特点

1. **01_标准格式_学号学生姓名.xlsx**
   - 列名: ['学号', '学生姓名']
   - 特点: 标准格式，应该能精确匹配

2. **02_多字格式_学号号学生姓名名.xlsx**
   - 列名: ['学号号', '学生姓名名']
   - 特点: 多了一个字，测试变体匹配

3. **03_错位格式_学学号学学生姓名.xlsx**
   - 列名: ['学学号', '学学生姓名']
   - 特点: 字符错位，测试模糊匹配

4. **04_颠倒格式_学生姓名学号.xlsx**
   - 列名: ['学生姓名', '学号']
   - 特点: 列名顺序颠倒，测试顺序容错

5. **05_空格格式_学号学生姓名.xlsx**
   - 列名: [' 学号 ', '学生姓名 ']
   - 特点: 包含空格，测试列名清理

6. **06_拼音格式_xuehao_student_name.xlsx**
   - 列名: ['xuehao', 'student_name']
   - 特点: 拼音格式，测试变体匹配

7. **07_大小写格式_学号Student_Name.xlsx**
   - 列名: ['学号', 'Student_Name']
   - 特点: 大小写混合，测试格式容错

8. **08_特殊字符格式_学号学生姓名（中文）.xlsx**
   - 列名: ['学号', '学生姓名（中文）']
   - 特点: 包含特殊字符，测试字符清理

9. **09_额外列格式_学号学生姓名班级成绩.xlsx**
   - 列名: ['学号', '学生姓名', '班级', '成绩']
   - 特点: 包含额外列，测试字段选择

10. **10_混合格式_学号学生姓名班级成绩.xlsx**
    - 列名: ['学号号', '学生姓名名', '班级', '成绩']
    - 特点: 混合格式，综合测试

## 测试步骤

1. **启动程序**
   ```bash
   python excel_merger.py
   ```

2. **配置智能匹配**
   - 启用智能列名匹配
   - 启用自动清理列名
   - 设置相似度阈值为0.8

3. **选择文件**
   - 输入文件夹路径: 当前目录下的test_excel_files
   - 选择所有文件或部分文件进行测试

4. **选择字段**
   - 尝试选择: 学号、学生姓名
   - 观察智能匹配的效果

5. **观察结果**
   - 查看匹配成功率
   - 检查列名映射是否正确
   - 验证数据完整性

## 预期结果

- **v2.3版本**: 只有标准格式文件能成功匹配（约10%成功率）
- **v2.4版本**: 所有文件都应该能成功匹配（100%成功率）

## 测试要点

1. **精确匹配**: 标准格式文件应该直接匹配
2. **变体匹配**: 多字、拼音格式应该通过变体映射匹配
3. **模糊匹配**: 错位、空格格式应该通过相似度算法匹配
4. **用户交互**: 模糊匹配时应该有用户确认步骤
5. **列名清理**: 空格和特殊字符应该被自动清理

## 成功标准

- 所有10个文件都能被正确处理
- 列名映射准确无误
- 数据完整且正确
- 用户体验友好
- 处理速度合理

祝测试顺利！ 