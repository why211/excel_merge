用例1：多源同步-常规更新
前置数据: 源文件 file.xls、file1.xls；目标文件 0718-39、教师考核数据子类（孔晓波）1.xls
操作步骤:
1) PowerShell 执行: python excel_tool.py 回车
2) 选 2 Excel数据同步 → 选 2 多个源文件
3) 源文件输入: 2,3；目标文件输入: 1
4) 关联字段界面按提示，手动选择“教工号”
5) 更新字段选择：*教职工考核单位号
6) 冲突处理方式选 2（使用第一个源文件的数据）
7) 选择输出目录并执行同步；结束按回车
期望结果: 显示“建议选择关联字段: 教工号”；更新字段列表包含 *教职工考核单位号；成功生成“...多源同步_时间戳.xlsx”，更新记录数>0，无报错
用例2：多源同步-字段模糊匹配提示
前置数据: file.xls 含 DEPT_NAME，file1.xls 含 部门名称，目标文件含 部门名称
操作步骤: 同用例1，进入关联/更新字段步骤时观察“检测源文件字段匹配情况...”
期望结果: 输出“file.xls 的 'DEPT_NAME' 与 file1.xls 的 '部门名称' 相似度: ≥0.80”的提示；系统仅提示不自动映射，由用户继续手动选择
用例3：多源同步-冲突处理（询问）
前置数据: 两个源文件在同一教工号的同一字段提供不同值
操作步骤:
1) 流程同用例1
2) 关联字段选“教工号”
3) 更新字段选包含冲突字段
4) 冲突处理方式选 1（询问用户）
5) 出现冲突时，按编号选择来源或输入 skip
期望结果: 展示每个来源值，用户选择后该记录按所选值更新；skip 时该记录该字段不更新；同步完成无异常
用例4：合并功能-按学号去重
前置数据: 两个学生信息表（如“学生信息1.xlsx”“学生信息2.xlsx”）包含重复学号
操作步骤:
1) python excel_tool.py 回车 → 选 1 Excel文件合并
2) 选择包含两个学生表的目录
3) 字段选择含“学号、学生姓名、班级、成绩”
4) 选择去重=是，去重字段=学号
5) 设置输出文件名，执行导出；结束按回车
期望结果: 导出含“合并数据/处理统计/字段信息”三个工作表；处理统计显示删除重复记录数>0；合并后行数减少
用例5：智能建议但不自动决策
前置数据: 源/目标存在多个共同字段（如“教工号”“教职工考核单位号”等）
操作步骤:
1) 进入多源同步（同用例1）
2) 关联字段步骤：看到“建议选择关联字段: 教工号”，手动输入编号选择
3) 更新字段步骤：显示可更新字段数量与列表，手动输入编号（或 all）
期望结果: 关联字段仅提示不自动选择；更新字段需手动确认或 all；流程可正常完成并输出文件
备注
命令执行: 在 PowerShell 进入 G:\wang\python 后运行 python excel_tool.py
输入分隔符使用半角逗号，例如 2,3（避免全角逗号）
用例6：多源同步-空关联值行不更新
前置数据: 目标文件含部分空的“教工号”；源文件 file.xls、file1.xls 正常
步骤: 进入多源同步→选源 2,3→目标 1→关联字段选“教工号”→更新字段选“教职工考核单位号”→冲突处理任意→执行
期望: 目标中教工号为空的记录不被更新；最终成功输出结果文件
用例7：多源同步-全角逗号输入重试
前置数据: 同上
步骤: 源文件编号输入“2，3”（全角逗号）→观察提示→改为“2,3”→后续流程同常规
期望: 首次提示“请输入有效的数字”，二次输入半角后可正常继续并完成同步
用例8：多源同步-无共同字段阻断
前置数据: 任意选一个源文件（或临时拷贝）仅含与目标完全不同的列
步骤: 源文件选择含该异常源文件+任意一个正常源→目标正常→进入“关联字段选择”
期望: 提示“目标文件和源文件没有共同的字段，无法进行同步”，流程终止，无输出文件
用例9：多源同步-未匹配记录使用默认值
前置数据: 源文件缺少部分目标中存在的“教工号”记录；更新字段为“教职工考核单位号”
步骤: 进入多源同步→选 2,3→目标 1→关联合法→更新字段选“教职工考核单位号”→未匹配处理选“2 使用默认值”，分别为该字段设置默认值→执行
期望: 同步完成后统计显示未匹配记录数>0；这些未匹配记录的该字段填入设定默认值
用例10：合并功能-英文列名智能对应
前置数据: 两个待合并文件其中一个含英文列 student_id、student_name、class_name；另一个含中文“学号/学生姓名/班级”
步骤: 进入合并→选择两文件→字段选择包含学号/学生姓名/班级（若有建议/提示，按建议或手动对应）→可选去重=否→导出
期望: 合并成功，导出含“合并数据/处理统计/字段信息”；三列成功对齐为统一列名，记录数为两表之和（未去重）