# Excel 文件处理脚本

这个脚本用于遍历指定文件夹中的所有 Excel 文件，读取"学号"和"\*学生姓名"列的数据，合并后保存为新的 Excel 文件。

## 功能特点

-   自动遍历文件夹中的所有 Excel 文件（.xlsx 和.xls 格式）
-   读取指定的"学号"和"\*学生姓名"列
-   自动跳过缺少所需列的文件并给出提示
-   合并所有数据并去除重复的学号
-   保存为新的 Excel 文件
-   智能处理文件占用问题，自动生成新文件名
-   包含详细的处理日志

## 安装依赖

在运行脚本之前，请先安装必要的 Python 包：

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install pandas openpyxl xlrd
```

## 使用方法

### 方法 1：交互式运行

```bash
python excel_processor.py
```

然后按提示输入文件夹路径和输出文件名。

### 方法 2：直接调用函数

```python
from excel_processor import process_excel_files

# 处理指定文件夹中的Excel文件
process_excel_files("你的文件夹路径", "输出文件名.xlsx")
```

## 输入文件要求

-   Excel 文件必须包含"学号"和"\*学生姓名"两列
-   支持.xlsx 和.xls 格式
-   如果文件缺少所需列，脚本会自动跳过并给出警告

## 输出文件

-   默认输出文件名为"result.xlsx"
-   包含以下列：
    -   学号
    -   \*学生姓名
    -   来源文件（记录数据来源的文件名）

## 注意事项

-   脚本会自动去除重复的学号，保留第一次出现的记录
-   所有处理过程都会在控制台显示详细的日志信息
-   如果遇到文件读取错误，脚本会跳过该文件并继续处理其他文件
