请帮我完成以下任务：

## 需求描述

基于现有的Excel文件处理脚本，需要增加以下功能：

### 1. 可选择的去重功能
- 在输出结果时，提供选项让用户选择是否进行去重
- 如果选择去重，则按学号去重；如果不选择去重，则保留所有重复记录
- 在交互式版本中，通过用户输入来控制去重选项
- 在简化版本中，通过参数来控制去重选项

### 2. 字段数量统计功能
- 首先扫描指定文件夹中的所有Excel文件
- 统计所有文件中出现的字段（列名）总数
- 显示每个字段在哪些文件中出现
- 生成字段统计报告

### 3. 基于字段选择的文件合并功能
- 根据用户输入的字段名，确定哪些Excel文件包含这些字段
- 只处理包含指定字段的文件
- 如果某个文件缺少指定字段，则跳过该文件
- 支持多个字段的选择

## 技术要求

### 修改现有脚本
- 修改 `excel_processor.py` 和 `excel_processor_simple.py`
- 保持原有的"学号"和"*学生姓名"列作为默认选项
- 添加新的参数来控制去重和字段选择

### 新增功能函数
1. `analyze_excel_fields(folder_path)` - 分析文件夹中所有Excel文件的字段
2. `select_files_by_fields(folder_path, required_fields)` - 根据字段选择文件
3. `process_with_deduplication_option()` - 带去重选项的处理函数

### 用户交互
- 交互式版本：询问用户是否需要去重，以及需要合并哪些字段
- 简化版本：通过函数参数控制这些选项

## 输出要求

### 字段分析报告
- 显示所有发现的字段及其出现频率
- 显示每个字段在哪些文件中出现
- 提供字段选择的建议

### 处理结果
- 根据用户选择的字段进行合并
- 根据用户选择决定是否去重
- 保持原有的文件占用处理和错误处理机制

## 示例用法

```python
# 分析字段
analyze_excel_fields("excel")

# 处理文件（不去重）
process_excel_files("excel", "result.xlsx", required_fields=["学号", "*学生姓名"], deduplicate=False)

# 处理文件（去重）
process_excel_files("excel", "result.xlsx", required_fields=["学号", "*学生姓名"], deduplicate=True)
```

请直接给出完整的Python代码实现，包括所有新增功能和修改后的现有功能，谢谢！